name: $(Date:yyyyMMdd).$(Rev:r) # Custom build numbering format

trigger:
  branches:
    include:
      - devops
      - feat/*
  paths:
    exclude:
      - 'apps/boilerplate/*'
      - 'apps/digiroom/*'
      - 'apps/digiroom-cms/*'
      - 'apps/digiroom-new-car-purchase/*'
      - 'apps/digiroom-promo/*'
    include:
      - 'apps/digiroom-news/*'

pool:
  vmImage: ubuntu-latest

jobs:
- job: BuildAndDeploy
  displayName: 'Build and Deploy'
  steps:
  - task: Npm@1
    inputs:
      command: 'install'
      workingDir: '.' # Set the working directory to the root of the repository
  - task: PowerShell@2
    inputs:
      targetType: 'inline'
      script: |
        cd .\apps\digiroom-news\
  - task: Npm@1
    inputs:
      command: 'install'
      workingDir: 'apps/digiroom-news/' # Set the working directory
  - task: Npm@1
    inputs:
      command: 'custom'
      workingDir: 'apps/digiroom-news/' # Set the working directory
      customCommand: 'run build'
